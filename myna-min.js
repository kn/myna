(function(){var c,i,h;h=this;i=h.Myna;c={};c="undefined"!==typeof exports?exports:h.Myna={};c.VERSION="0.1.0";c.noConflict=function(){h.Myna=i;return this};c.compile=function(a){var e,b,f,d;d=a.text;f=a.user.name;b=a.entities.user_mentions;e=a.entities.hashtags;f+=" "+c._get_context(b,d)+": ";d=c._slice_context(d);d=c._replace_rt_with_speakable(b,d);d=c._replace_mentions_with_speakable(b,d);d=c._replace_hashtags_with_speakable(e,d);d=c._replace_urls_with_speakable(a.entities.urls,d);return f+d};c._get_context=
function(a,e){var b;if(e.match(/^OH[\s:]/))return"overheard";if(b=e.match(/^RT\s@(\w+):/))return b=c._get_name_by_screen_name(a,b[1]),"retweeted a tweet of "+b;if(e.match(/^RT[\s:]/))return"retweeted";return e.match(/^(@\w+\s)+/)?(b=c._get_in_reply_to_array(a),b=c._en_and_join(b),"tweeted in reply to "+b):"tweeted"};c._slice_context=function(a){return a.replace(/^(OH[\s:]|RT\s@(\w+):|RT[\s:]|(@\w+\s)+)/,"").trim()};c._replace_rt_with_speakable=function(a,e){var b;if(b=e.match(/\sRT\s@(\w+):\s/))b=
c._get_name_by_screen_name(a,b[1]),e=e.replace(/\sRT\s@\w+:\s/," in reply to a tweet of "+b+": ");return e.replace(/\sRT(\s|:\s)/," in reply to: ")};c._replace_hashtags_with_speakable=function(a,e){var b,f,d,g,a=e.match(/#\w+/g);if(null!=a)for(d=0,g=a.length;d<g;d++)b=a[d],f=RegExp(b),e=e.replace(f,c._spacify(b.slice(1,b.length-1+1||9E9)));return e};c._replace_urls_with_speakable=function(a,e){var b,c,d,g;for(d=0,g=a.length;d<g;d++)b=a[d],c=b.display_url?b.display_url.replace(/^([^\/]+)\/.*$/,"(Link to $1)"):
b.expanded_url?b.expanded_url.replace(/^([^\/]+)\/.*$/,"(Link to $1)"):b.url.replace(/^([^\/]+)\/.*$/,"(Link to $1)"),c=c.replace(/\./g," dot "),b=RegExp(""+b.display_url+"|"+b.url),e=e.replace(b,c);return e};c._replace_mentions_with_speakable=function(a,e){var b,c,d,g;for(d=0,g=a.length;d<g;d++)b=a[d],c=RegExp("@"+b.screen_name),e=e.replace(c,b.name);return e};c._get_name_by_screen_name=function(a,c){var b,f,d;for(f=0,d=a.length;f<d;f++)if(b=a[f],b.screen_name===c)return b.name};c._en_and_join=function(a){var c;
if(1===a.length)return a[0];if(2===a.length)return""+a[0]+" and "+a[1];if(2<a.length)return c=a.slice(0,a.length-2+1||9E9).join(", "),""+c+" and "+a[a.length-1]};c._spacify=function(a){a=a.replace(/_/g," ");a=a.replace(/([A-Z][a-z]+)/g," $1 ");a=a.replace(/\s\s/g," ");return a.trim()};return c._get_in_reply_to_array=function(a){var c,b,f,d,g;c=[];if(a){b=0;for(d=0,g=a.length;d<g;d++)if(f=a[d],3>f.indices[0]-b)c.push(f.name),b=f.indices[1];else break}return c}}).call(this);
