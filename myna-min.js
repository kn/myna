(function(){var b,i,h;h=this;i=h.Myna;b={};b="undefined"!==typeof exports?exports:h.Myna={};b.VERSION="0.1.0";b.noConflict=function(){h.Myna=i;return this};b.compile=function(a){var e,c,f,d;d=a.text;f=a.user.name;c=a.entities.user_mentions;e=a.entities.hashtags;f+=" "+b._get_context(c,d)+": ";d=b._slice_context(d);d=b._replace_rt_with_speakable(c,d);d=b._replace_mentions_with_speakable(c,d);d=b._replace_hashtags_with_speakable(e,d);d=b._replace_urls_with_speakable(a.entities.urls,d);return f+d};b._get_context=
function(a,e){var c;if(e.match(/^OH[\s:]/))return"overheard";if(c=e.match(/^RT\s@(\w+):/))return c=b._get_name_by_screen_name(a,c[1]),"retweeted a tweet of "+c;if(e.match(/^RT[\s:]/))return"retweeted";return e.match(/^(@\w+\s)+/)?(c=b._get_in_reply_to_array(a),c=b._en_and_join(c),"tweeted in reply to "+c):"tweeted"};b._slice_context=function(a){return a.replace(/^(OH[\s:]|RT\s@(\w+):|RT[\s:]|(@\w+\s)+)/,"").trim()};b._replace_rt_with_speakable=function(a,e){var c;if(c=e.match(/\sRT\s@(\w+):\s/))c=
b._get_name_by_screen_name(a,c[1]),e=e.replace(/\sRT\s@\w+:\s/," in reply to a tweet of "+c+": ");return e.replace(/\sRT(\s|:\s)/," in reply to: ")};b._replace_hashtags_with_speakable=function(a,e){var c,f,d,g,a=e.match(/#\w+/g);if(null!=a)for(d=0,g=a.length;d<g;d++)c=a[d],f=RegExp(c),e=e.replace(f,b._spacify(c.slice(1,c.length-1+1||9E9)));return e};b._replace_urls_with_speakable=function(a,e){var c,b,d,g;for(d=0,g=a.length;d<g;d++)c=a[d],b=c.display_url.replace(/^([^\/]+)\/.*$/,"(Link to $1)"),b=
b.replace(/\./g," dot "),c=RegExp(""+c.display_url+"|"+c.url),e=e.replace(c,b);return e};b._replace_mentions_with_speakable=function(a,e){var c,b,d,g;for(d=0,g=a.length;d<g;d++)c=a[d],b=RegExp("@"+c.screen_name),e=e.replace(b,c.name);return e};b._get_name_by_screen_name=function(a,b){var c,f,d;for(f=0,d=a.length;f<d;f++)if(c=a[f],c.screen_name===b)return c.name};b._en_and_join=function(a){var b;if(1===a.length)return a[0];if(2===a.length)return""+a[0]+" and "+a[1];if(2<a.length)return b=a.slice(0,
a.length-2+1||9E9).join(", "),""+b+" and "+a[a.length-1]};b._spacify=function(a){a=a.replace(/_/g," ");a=a.replace(/([A-Z][a-z]+)/g," $1 ");a=a.replace(/\s\s/g," ");return a.trim()};return b._get_in_reply_to_array=function(a){var b,c,f,d,g;b=[];if(a){c=0;for(d=0,g=a.length;d<g;d++)if(f=a[d],3>f.indices[0]-c)b.push(f.name),c=f.indices[1];else break}return b}}).call(this);
